<!doctype html>
<html lang="en">
  <head>
	<title>EggCollector Game</title>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    
    <!-- Custom styles for this template -->
    <link href="heroes.css" rel="stylesheet">


  </head>
  <body>



<main>

  <div class="px-4 py-5 my-5 text-center" id="splash">
    <img class="d-block mx-auto mb-4" src="./scans/egg-main.png" alt="Hoppy Easter 2024" width="90" height="120">
    <h1 class="display-5 fw-bold">EggCollector Game</h1>
    <div class="col-lg-6 mx-auto">
      <p class="lead mb-4">Collect eggs by answering maths questions correctly!</p>
      <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
        <button type="button" class="btn btn-primary btn-lg px-4 gap-3" onClick="startGame('easy')">Play now (easy)</button>
        <button type="button" class="btn btn-outline-secondary btn-lg px-4" onClick="startGame('hard')">Hard mode</button>
      </div>
    </div>
  </div>

  <div class="px-4 py-5 my-5 text-center" id="game" style="display:none">
  	<p class="muted"><span id="points">0</span> points</p>
  	<img class="d-block mx-auto mb-4" src="./scans/basket.png" alt="Egg basket" width="90" height="120">

  	<input type="hidden" id="question-number" value="0"/>

    <h1 class="display-5 fw-bold">EggCollector Game</h1>
    <div class="col-lg-4 mx-auto">
      <p class="lead mb-4">Question: <span id="questionText">----</span></p>
    </div>
    <div class="col-lg-2 mx-auto">
      <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
      	<div class="xinput-group mb-3 text-center">
      		<div class="btn-group" role="group" aria-label="Basic outlined example">
			  <button type="button" class="answerButton btn btn-outline-primary" id="answer-1" data-answer-val="1">.</button>
			  <button type="button" class="answerButton btn btn-outline-primary" id="answer-2" data-answer-val="2">.</button>
			  <button type="button" class="answerButton btn btn-outline-primary" id="answer-3" data-answer-val="3">.</button>
			</div>
		</div>
      </div>
    </div>
  </div>

  <div id="ready"></div>

  <div class="b-example-divider"></div>

</main>
	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
  
	<script>

		var points = 0;
		var pointsWon = 0;
		var won = 0;
		var lost = 0;
		var questionsStack;
		var questionNumber = 0;

		$(document).ready(function(){
			console.log('EggCollector game ready');

			// bind the click
			$('.answerButton').on('click',function(){
				console.log('Answer button clicked');
				checkAnswer($(this).data('answer-val'));
			});
		});

		function startGame(difficulty) {
			if (difficulty == 'easy') {
				questionsStack = easyQuestions();
			}
			if (difficulty == 'hard') {
				questionsStack = hardQuestions();
			}

			console.log('Game starting with difficulty', difficulty, questionsStack);


			$('#splash').hide();
			questionNumber = 0;

			setNextQuestionAndAnswers(questionNumber);

			$('#game').fadeIn();
		}

		function updatePoints() {
			$('#points').text(points);
		}

		function winRound() {
			// alert('yes!');
			console.log('Correct answer');
			points++;
			updatePoints();
			if (points == 5) {
				winGame();
			}
		}

		function loseRound() {
			// alert('nope!');
			console.log('Wrong answer');
			points--;
			updatePoints();
			if (points <= 0) {
				loseGame();
			}
		}

		function winGame() {
			alert('Game over! You won, now eat all those eggs!');
		}

		function loseGame() {
			alert('Game over! You lost all the eggs :o(');
		}

		function checkAnswer(thisButtonVal) {
			// their answer is multiple choice not an input
			// hence bring the value from the button they clicked
			var currentAnswer = thisButtonVal;

			// we need the current question number to know if they
			// got the answer right or not
			var currentQuestionNumber = $('#question-number').val();
			var currentQuestion = questionsStack[currentQuestionNumber];

			if (currentAnswer === currentQuestion.a) {
				winRound();
			} else {
				loseRound();
			}

			setNextQuestionAndAnswers(questionNumber + 1);

		}

		function setNextQuestionAndAnswers(questionNumber) {
			// even for the first?
			$('#question-number').val(questionNumber);

			var nextQuestion = questionsStack[questionNumber];

			$('#questionText').text(nextQuestion.q);
			
			$('#answer-1').text(nextQuestion.ao[0]).data('answer-val', nextQuestion.ao[0]);
			$('#answer-2').text(nextQuestion.ao[1]).data('answer-val', nextQuestion.ao[1]);;
			$('#answer-3').text(nextQuestion.ao[2]).data('answer-val', nextQuestion.ao[2]);;

		}

		function easyQuestions() {
			var qs =[
				{
					q: "1x2",
					a: 2,
					ao: [
						2,1,4
					]
				},
				{
					q: "5x2",
					a: 10,
					ao: [
						2,10,5
					]
				}

			];
			return qs;
		}

		function hardQuestions() {
			var qs =[
				{
					q: "2x8",
					a: 16,
					ao: [
						14,18,16
					]
				},
				{
					q: "2x12",
					a: 24,
					ao: [
						42,12,24
					]
				}

			];
			return qs;
		}

	</script>

  </body>
</html>
